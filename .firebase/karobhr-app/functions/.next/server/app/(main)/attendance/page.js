(()=>{var e={};e.id=683,e.ids=[683],e.modules={3203:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>k});var s=r(60687),a=r(43210),i=r(87979),o=r(29523),n=r(44493),c=r(29867),l=r(11516),d=r(72963),u=r(26398),m=r(17445),p=r(13914),x=r(49497),f=r(36644),h=r(34729),g=r(63503),y=r(91821);r(44421),r(75535);var v=r(45481);function k(){let{user:e,companySettings:t,addAttendanceEvent:r,completeCheckout:k,loading:b}=(0,i.A)(),{toast:j}=(0,c.dj)(),[N,w]=(0,a.useState)(null),[C,A]=(0,a.useState)("unknown"),[q,P]=(0,a.useState)(null),[L,R]=(0,a.useState)(""),[F,M]=(0,a.useState)(!1),[z,_]=(0,a.useState)(null),[G,S]=(0,a.useState)("idle"),[E,T]=(0,a.useState)(null),[$,H]=(0,a.useState)(null),W=(0,a.useCallback)(async()=>{if(!navigator.geolocation){j({variant:"destructive",title:"Unsupported Browser",description:"Geolocation is not supported."});return}S("fetching"),j({title:"Getting your location..."}),navigator.geolocation.getCurrentPosition(r=>{let s={latitude:r.coords.latitude,longitude:r.coords.longitude,accuracy:r.coords.accuracy};T(s),S("success");let a=null,i=null;if(t?.officeLocation?(a=(0,v.g)(s.latitude,s.longitude,t.officeLocation.latitude,t.officeLocation.longitude),i="office"):e?.remoteWorkLocation&&(a=(0,v.g)(s.latitude,s.longitude,e.remoteWorkLocation.latitude,e.remoteWorkLocation.longitude),i="remote"),null!==a&&i){H(a);let e=a>1e3?`${(a/1e3).toFixed(2)} km`:`${a.toFixed(0)} m`;j({title:"Location Updated",description:`You are approx. ${e} from the ${i} geofence.`})}else j({variant:"destructive",title:"No Geofence Configured",description:"Could not find a valid office or remote geofence to compare against."})},e=>{S("error"),T(null),H(null),j({variant:"destructive",title:"Location Error",description:e.message})},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})},[t,e?.remoteWorkLocation,j]),Y=async()=>{if(!E){j({title:"Location Needed",description:"Please fetch your location before checking in.",variant:"destructive"});return}A("processing-check-in");try{await r(E)&&(j({title:"Check-In Successful!",description:"Your check-in has been recorded."}),T(null),H(null),S("idle"))}catch(e){j({title:"Check-In Failed",description:e.message||"Could not record check-in.",variant:"destructive"}),A("checked-out")}},B=async()=>{if(!q||!E||!L.trim()){j({title:"Missing Information",description:"A location, active check-in, and work report are required.",variant:"destructive"});return}M(!1),A("processing-check-out");try{await k(q,L,E),j({title:"Check-Out Successful!",description:"Your work report and check-out have been recorded."}),R(""),T(null),H(null),S("idle")}catch(e){j({title:"Check-Out Failed",description:e.message||"Could not record check-out.",variant:"destructive"}),A("checked-in")}},I=["processing-check-in","processing-check-out","submitting-report"].includes(C),O="checked-in"===C;return b||"unknown"===C?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-4",children:[(0,s.jsx)(l.A,{className:"h-12 w-12 animate-spin text-primary mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading attendance data..."})]}):"error"===C?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-8rem)] p-4 text-center",children:[(0,s.jsx)(d.A,{className:"h-12 w-12 text-destructive mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Attendance System Error"}),(0,s.jsx)("p",{className:"text-muted-foreground max-w-md",children:z})]}):(0,s.jsxs)("div",{className:"space-y-6 p-4 md:p-6 max-w-3xl mx-auto",children:[(0,s.jsxs)(n.Zp,{children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"text-2xl flex items-center",children:[(0,s.jsx)(u.A,{className:"mr-3 h-6 w-6 text-primary"})," My Attendance"]}),(0,s.jsx)(n.BT,{children:"First, fetch your location to verify you are within the geofence, then proceed to check in or out."})]}),(0,s.jsxs)(n.Wu,{className:"space-y-4",children:[(()=>{switch(G){case"fetching":return(0,s.jsx)("p",{className:"text-sm text-center text-muted-foreground",children:"Fetching location..."});case"success":if(null!==$){let r=$<=(t?.officeLocation?.radius??e?.remoteWorkLocation?.radius??0),a=$>1e3?`${($/1e3).toFixed(2)} km`:`${$.toFixed(0)} m`;return(0,s.jsxs)(y.Fc,{variant:r?"default":"destructive",className:"text-center",children:[(0,s.jsx)(y.XL,{children:r?"You are within the Geofence":"You are outside the Geofence"}),(0,s.jsxs)(y.TN,{children:["Approx. ",a," away from the required location."]})]})}return(0,s.jsx)("p",{className:"text-sm text-center text-muted-foreground",children:"Location fetched, but no geofence to compare."});case"error":return(0,s.jsx)(y.Fc,{variant:"destructive",className:"text-center",children:(0,s.jsx)(y.TN,{children:"Failed to get location. Please check browser permissions and try again."})});default:return(0,s.jsx)("p",{className:"text-sm text-center text-muted-foreground",children:"Click the button below to check your location status."})}})(),(0,s.jsxs)(o.$,{className:"w-full",variant:"secondary",onClick:W,disabled:"fetching"===G,children:["fetching"===G?(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Refresh My Location"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6",children:[(0,s.jsxs)(o.$,{size:"lg",className:"w-full py-6 text-lg",onClick:Y,disabled:I||"success"!==G||O,children:["processing-check-in"===C&&(0,s.jsx)(l.A,{className:"mr-2 h-5 w-5 animate-spin"}),(0,s.jsx)(p.A,{className:"mr-2 h-5 w-5"})," Check In"]}),(0,s.jsxs)(o.$,{size:"lg",variant:"outline",className:"w-full py-6 text-lg",onClick:()=>{if(!E){j({title:"Location Needed",description:"Please fetch your location before checking out.",variant:"destructive"});return}M(!0)},disabled:I||"success"!==G||!O,children:["processing-check-out"===C&&(0,s.jsx)(l.A,{className:"mr-2 h-5 w-5 animate-spin"}),(0,s.jsx)(x.A,{className:"mr-2 h-5 w-5"})," Check Out"]})]}),(0,s.jsx)(g.lG,{open:F,onOpenChange:M,children:(0,s.jsxs)(g.Cf,{children:[(0,s.jsxs)(g.c7,{children:[(0,s.jsxs)(g.L3,{className:"flex items-center",children:[(0,s.jsx)(f.A,{className:"mr-2 h-5 w-5 text-primary"}),"Daily Work Report"]}),(0,s.jsx)(g.rr,{children:"Before checking out, please submit a brief report of the work you completed today."})]}),(0,s.jsxs)("div",{className:"py-4 space-y-2",children:[(0,s.jsx)("label",{htmlFor:"workReport",className:"text-sm font-medium",children:"Work Report"}),(0,s.jsx)(h.T,{id:"workReport",value:L,onChange:e=>R(e.target.value),placeholder:"Enter your work summary here...",rows:5})]}),(0,s.jsxs)(g.Es,{children:[(0,s.jsx)(g.HM,{asChild:!0,children:(0,s.jsx)(o.$,{type:"button",variant:"outline",children:"Cancel"})}),(0,s.jsxs)(o.$,{onClick:B,disabled:I||!L.trim(),children:[I&&(0,s.jsx)(l.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Submit Report & Check Out"]})]})]})})]})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11516:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},13914:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},17445:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("LocateFixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},26398:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,t,r)=>{"use strict";r.d(t,{T:()=>o});var s=r(60687),a=r(43210),i=r(4780);let o=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));o.displayName="Textarea"},36644:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},37366:e=>{"use strict";e.exports=require("dns")},43812:(e,t,r)=>{Promise.resolve().then(r.bind(r,46513))},44493:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>d,ZB:()=>c,Zp:()=>o,aR:()=>n});var s=r(60687),a=r(43210),i=r(4780);let o=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));o.displayName="Card";let n=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));n.displayName="CardHeader";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));c.displayName="CardTitle";let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},46513:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/(main)/attendance/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/(main)/attendance/page.tsx","default")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63503:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>p,Es:()=>f,HM:()=>u,L3:()=>h,c7:()=>x,lG:()=>c,rr:()=>g,zM:()=>l});var s=r(60687),a=r(43210),i=r(26134),o=r(78726),n=r(4780);let c=i.bL,l=i.l9,d=i.ZL,u=i.bm,m=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hJ,{ref:r,className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));m.displayName=i.hJ.displayName;let p=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(d,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(i.UC,{ref:a,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,s.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(o.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));p.displayName=i.UC.displayName;let x=({className:e,...t})=>(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});x.displayName="DialogHeader";let f=({className:e,...t})=>(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});f.displayName="DialogFooter";let h=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.hE,{ref:r,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));h.displayName=i.hE.displayName;let g=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.VY,{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));g.displayName=i.VY.displayName},72963:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},73496:e=>{"use strict";e.exports=require("http2")},73668:(e,t,r)=>{Promise.resolve().then(r.bind(r,3203))},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},91821:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>c,TN:()=>d,XL:()=>l});var s=r(60687),a=r(43210),i=r(24224),o=r(4780);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef(({className:e,variant:t,...r},a)=>(0,s.jsx)("div",{ref:a,role:"alert",className:(0,o.cn)(n({variant:t}),e),...r}));c.displayName="Alert";let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));l.displayName="AlertTitle";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},94735:e=>{"use strict";e.exports=require("events")},99810:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>l});var s=r(65239),a=r(48088),i=r(88170),o=r.n(i),n=r(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);r.d(t,c);let l={children:["",{children:["(main)",{children:["attendance",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,46513)),"/home/user/studio/src/app/(main)/attendance/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,60448)),"/home/user/studio/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/user/studio/src/app/(main)/attendance/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/attendance/page",pathname:"/attendance",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,178,658,814,595,449,208],()=>r(99810));module.exports=s})();