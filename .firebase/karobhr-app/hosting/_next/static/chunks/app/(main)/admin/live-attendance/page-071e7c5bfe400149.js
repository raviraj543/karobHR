(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7818],{31:(e,t,a)=>{Promise.resolve().then(a.bind(a,7949))},286:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},1394:(e,t,a)=>{"use strict";a.d(t,{BK:()=>i,eu:()=>d,q5:()=>c});var r=a(5155),s=a(2115),l=a(4011),n=a(9434);let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});d.displayName=l.bL.displayName;let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",a),...s})});i.displayName=l._V.displayName;let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(l.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});c.displayName=l.H4.displayName},1949:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(157).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5127:(e,t,a)=>{"use strict";a.d(t,{A0:()=>d,BF:()=>i,Hj:()=>c,XI:()=>n,nA:()=>m,nd:()=>o});var r=a(5155),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",a),...s})})});n.displayName="Table";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...s})});d.displayName="TableHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...s})});i.displayName="TableBody",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s})}).displayName="TableFooter";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e,{key:n,...d}=s;return(0,r.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...d})});c.displayName="TableRow";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...s})});o.displayName="TableHead";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});m.displayName="TableCell",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...s})}).displayName="TableCaption"},6126:(e,t,a)=>{"use strict";a.d(t,{E:()=>d});var r=a(5155);a(2115);var s=a(2085),l=a(9434);let n=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)(n({variant:a}),t),...s})}},6681:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(2115),s=a(8232);let l=()=>{let e=(0,r.useContext)(s.c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>i,Zp:()=>n,aR:()=>d});var r=a(5155),s=a(2115),l=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...s})});d.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});i.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",a),...s})});o.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},7949:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>R});var r=a(5155),s=a(2115),l=a(6681),n=a(6695),d=a(5127),i=a(6126),c=a(1394),o=a(172),m=a(157);let u=(0,m.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var f=a(286);let h=(0,m.A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),x=(0,m.A)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var p=a(1949);let y=(0,m.A)("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),j=(0,m.A)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var v=a(7648),N=a(3343),k=a(657),b=a(4598),w=a(9340);function g(e){return(0,w.r)(e,(0,b.A)(e))}var A=a(3013),C=a(1725),H=a(2846);let M=e=>{let{checkInTime:t}=e,[a,l]=(0,s.useState)(0);if((0,s.useEffect)(()=>{try{let e=(0,N.H)(t),a=setInterval(()=>{l((0,k.b)(new Date,e))},1e3);return()=>clearInterval(a)}catch(e){return}},[t]),a<0)return(0,r.jsx)("span",{children:"-"});let n=Math.floor(a/36e5),d=Math.floor(a%36e5/6e4),i=Math.floor(a%6e4/1e3);return(0,r.jsx)("span",{className:"font-mono",children:"".concat(n,"h ").concat(d,"m ").concat(i,"s")})};function R(){let{allUsers:e,attendanceLog:t,loading:a}=(0,l.A)(),[m,b]=(0,s.useState)(new Date);(0,s.useEffect)(()=>{document.title="Live Employee Attendance - Admin - KarobHR";let e=setInterval(()=>{b(new Date)},1e4);return()=>clearInterval(e)},[]);let w=(0,s.useMemo)(()=>{if(a)return[];let r=e.filter(e=>"employee"===e.role||"manager"===e.role),s=new Date;return r.map(e=>{let a,r,l,n;let d=t.filter(t=>t.userId===e.id&&t.timestamp).sort((e,t)=>(0,N.H)(t.timestamp).getTime()-(0,N.H)(e.timestamp).getTime()),i=d[0],c=d.filter(e=>e.timestamp&&g((0,N.H)(e.timestamp))),o="Away",m=c.reduce((e,t)=>"Checked Out"===t.status&&void 0!==t.totalHours&&null!==t.totalHours?e+t.totalHours:e,0),u=0,f=c.find(e=>"check-in"===e.type&&"Checked In"===e.status);if(f&&f.timestamp){let e=(0,N.H)(f.timestamp);g(e)&&(u=(0,k.b)(s,e)/36e5,n=f.timestamp)}return m+=u,i&&(o="check-in"===i.type?"Checked In":"Checked Out",a=i.timestamp,r=i.isWithinGeofence,l=i.checkInLocation),{user:e,status:o,lastActivityTime:a,isWithinGeofence:r,location:l,liveCheckInTime:n,workingHoursToday:(0,H.a3)(36e5*m)}}).sort((e,t)=>(e.user.name||"").localeCompare(t.user.name||""))},[e,t,a,m]);return a?(0,r.jsxs)("div",{className:"flex items-center justify-center h-full py-10",children:[(0,r.jsx)(o.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"ml-2 text-muted-foreground",children:"Loading attendance data..."})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Live Employee Attendance"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Real-time overview of employee check-in/out status. This page updates automatically."})]})}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center",children:[(0,r.jsx)(u,{className:"mr-2 h-3 w-3 animate-spin",style:{animationDuration:"10s"}}),"Last updated: ",(0,A.GP)(m,"PPpp")]}),(0,r.jsxs)(n.Zp,{className:"shadow-sm",children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center",children:[(0,r.jsx)(f.A,{className:"mr-2 h-5 w-5 text-primary"}),"Employee Status"]}),(0,r.jsx)(n.BT,{children:"Current attendance status and activity for all employees and managers."})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)(d.XI,{children:[(0,r.jsx)(d.A0,{children:(0,r.jsxs)(d.Hj,{children:[(0,r.jsx)(d.nd,{children:"Employee"}),(0,r.jsx)(d.nd,{children:"Status"}),(0,r.jsx)(d.nd,{children:"Last Activity"}),(0,r.jsx)(d.nd,{children:"Geofence"}),(0,r.jsx)(d.nd,{children:"Live Session Duration"}),(0,r.jsx)(d.nd,{children:"Total Hours (Today)"})]})}),(0,r.jsxs)(d.BF,{children:[w.map(e=>{let{user:t,status:a,lastActivityTime:s,isWithinGeofence:l,liveCheckInTime:n,workingHoursToday:o}=e;return(0,r.jsxs)(d.Hj,{className:"hover:bg-muted/50 transition-colors",children:[(0,r.jsx)(d.nA,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)(c.eu,{className:"h-9 w-9 border",children:[(0,r.jsx)(c.BK,{src:t.profilePictureUrl||void 0,alt:t.name||"User"}),(0,r.jsx)(c.q5,{children:t.name?t.name.split(" ").map(e=>e[0]).join(""):"U"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:t.name||"N/A"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground font-mono",children:t.employeeId})]})]})}),(0,r.jsx)(d.nA,{children:(0,r.jsxs)(i.E,{variant:"Checked In"===a?"default":"Checked Out"===a?"secondary":"outline",className:"capitalize",children:["Checked In"===a&&(0,r.jsx)(h,{className:"mr-1.5 h-3.5 w-3.5"}),"Checked Out"===a&&(0,r.jsx)(x,{className:"mr-1.5 h-3.5 w-3.5"}),"Away"===a&&(0,r.jsx)(p.A,{className:"mr-1.5 h-3.5 w-3.5"}),a]})}),(0,r.jsx)(d.nA,{className:"text-sm text-muted-foreground",children:s?(0,C.m)((0,N.H)(s),{addSuffix:!0}):"N/A"}),(0,r.jsx)(d.nA,{children:null==l?(0,r.jsx)(i.E,{variant:"outline",children:"N/A"}):l?(0,r.jsxs)(i.E,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:[(0,r.jsx)(y,{className:"mr-1 h-3 w-3"})," Within"]}):(0,r.jsxs)(i.E,{variant:"destructive",children:[(0,r.jsx)(j,{className:"mr-1 h-3 w-3"})," Outside"]})}),(0,r.jsx)(d.nA,{children:"Checked In"===a&&n?(0,r.jsx)(M,{checkInTime:n}):(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"-"})}),(0,r.jsxs)(d.nA,{className:"font-medium",children:[(0,r.jsx)(v.A,{className:"inline-block mr-1.5 h-4 w-4 text-primary/80"}),o]})]},t.id)}),0===w.length&&!a&&(0,r.jsx)(d.Hj,{children:(0,r.jsx)(d.nA,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No employee attendance data available for today."})})]})]})})]})]})}},9340:(e,t,a)=>{"use strict";a.d(t,{r:()=>s});var r=a(644);function s(e,t){return+(0,r.o)(e)==+(0,r.o)(t)}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,6073,4277,4644,2296,6143,7275,8441,1684,7358],()=>t(31)),_N_E=e.O()}]);